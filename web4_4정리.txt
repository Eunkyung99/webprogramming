4.4 폼 처리하기
앞에서 폼을 처리하는 것을 간단히 살펴봄(3장의 detail.html 템플릿에서 투표용 라디오 버튼을 보여주는 폼을 작성하였고, vote() 뷰 함수에서 이 폼을 처리하는 로직을 작성함.
장고의 폼 처리 기능
1) HTML에서의 폼
우리는 웹 사이트를 개발할 때 사용자로부터 입력을 받기 위해 폼을 사용.
HTML-<form>…</form> 사이에 있는 엘리먼트들의 집합
웹 사이트 사용자는 폼을 통해 텍스트를 입력할 수도, 항목을 선택할 수도 있음
폼에 입력된 데이터: 서버로 보내짐
텍스트 입력, 체크 박스 등과 같은 간단한 폼의 엘리먼트들은 기본 위젯 사용
달력 위젯, 슬라이드 바 등의 복잡한 엘리먼트들: 자바 스크립트나 CSS 사용
폼은 <input> 엘리먼트 외에도 폼 데이터를 어디로 보낼지 지정해주는 action 속성과 어떤 HTTP 메소드로 보낼지 지정해주는 method 속성을 설정해주어야 함
HTTP 프로토콜 중 폼에서 사용할 수 있는 HTTP 메소드: GET, POST
폼의 데이터를 전송할 때: POST만 사용(장고)
*POST-서버 시스템의 상태 바꾸는 요청(데이터베이스의 내용을 변경하는 요청)
GET-서버 시스템의 상태를 바꾸지 않는 요청
패스워드가 URL이나 브라우저 히스토리, 서버의 로그에 텍스트로 보일 수 있기 때문에 GET은 패스워드 폼에서도 사용하지 않음
GET: 폼 데이터량이 많거나 이미지와 같은 2진 데이터를 보내는 경우에도 부적합하고 보안에도 취약하기 때문에 모두 POST 방식 사용+장고의 CSRF 방지 기능->보안 강화
BUT 검색 폼: GET 방식이 적절(GET 방식의 데이터가 URL에 포함되므로 URL을 북마크해두고 쉽게 공유하거나 재전송할 수 있음)

2) 장고의 폼 기능
웹 서버에서의 폼 처리: 공통 절차
ex) Admin 사이트
여러 타입의 많은 위젯이 폼 화면 출력용으로 준비되어야 하고 HTML로 렌더링되며 적절한 인터페이스를 사용하여 입력 및 수정되고 서버로 보내져서 데이터가 유효한지 검증을 거친 후에 적절한 처리를 위해 저장되거나 전달됨.
->장고 -폼 생성에 필요한 데이터를 폼 클래스로 구조화하기
       -폼 클래스의 데이터를 렌더링하여 HTML 폼 만들기
       -사용자로부터 제출된 폼과 데이터를 수신하고 처리하기
웹에서의 폼: 1)HTML의 <form>
	    2) <form>을 만들어내는 장고의 Form 클래스
	    3) 서버로 제출된 구조화된 데이터
모델 클래스의 필드가 데이터베이스의 필드로 매핑되듯이 폼 클래스의 필드도 HTML 폼의 <input> 엘리먼트에 매핑됨.
필드는 폼 데이터를 저장하고 있으며, 폼이 제출되면 자신의 데이터에 대한 유효성 검사를 실시함. 필드는 저장하는 데이터의 종류에 따라 자신의 타입을 가짐
또한 폼의 필드는 브라우저에서 HTML 위젯으로 표현되고 필드 타입마다 디폴트 위젯 클래스를 가지고 있으며 필요 시 오버라이딩될 수 있음
ex) 장고의 DataField: 날짜와 관련된 데이터 다룸
	  FileField: 파일과 관련된 데이터 다룸
	->서로 다른 종류의 데이터를 처리할 뿐만 아니라 유효성 검사 방식도 다르고 디폴트 위
젯 클래스도 다름
폼도 결국 템플릿의 일부이므로 템플릿 코드에 포함되어서 렌더링 절차를 거침
장고에서 객체를 렌더링할 때 3가지 과정
-렌더링할 객체를 뷰로 가져오기(데이터베이스로부터 객체 추출하기)
-그 객체를 템플릿 시스템으로 넘겨주기
-템플릿 문법을 처리해서 HTML 마크업 언어로 변환하기
*폼 객체에는 데이터가 없을 수도 있음!
(폼 객체는 렌더링 이후에 사용자가 데이터를 채우는 것이 보통이므로 빈 객체를 렌더링하는 경우 자주 발생)
뷰 함수에서 폼 객체를 생성할 때는 데이터 없이 만들 것인지, 데이터를 채워서 만들 것인지 구분해서 코딩해야 함.
데이터를 채울 때는 저장된 모델 객체로부터 채울 수도 있고, 또는 직전에 제출된 HTML 폼으로부터 채울 수도 있음.
후자는 폼 필드가 여러 개인 경우 하나의 필드에서 에러가 발생하여 다시 폼 데이터를 입력할 때 에러가 없는 다른 필드들은 직전에 제출된 폼으로부터 데이터를 채우고 사용자에게 보여주는 경우가 예
데이터가 없는 폼: 언바운드 폼(사용자에게 비어있거나 디폴트 값으로 보여짐)
바운드 폼: 제출된 데이터를 갖고 있어 데이터의 유효성을 검사하는 데 사용

3) 폼 클래스로 폼 생성
장고에서 폼을 어떻게 생성할까.->폼도 클래스로 정의해서 간편하게 만들 수 있음
사용자의 이름을 취득하기 위해 간단한 폼을 만드는 경우
<form action=”/your-name/” method=”post”>
	<label for=”your_name”>Your name: </label>
	<input id=”your_name” type=”text” name=”your_name” value=”{{ current_name }}”>
	<input type=”submit” value=”OK”>
</form>
 
위 예제는 POST 방식을 이용해서 브라우저에게 폼 데이터를 URL /your-name/으로 보내달라고 요청. {{ current_name }} 템플릿 변수는 템플릿 렌더링을 요청하는 뷰에서 그 변수값을 지정해줄 것임. 폼이 제출되면 POST 요청에 폼 데이터가 담겨서 서버로 보내짐.
그리고 URL /your-name/에 해당하는 뷰가 있어서 요청 데이터에서 이름/값 쌍을 찾아서 뷰의 로직에 따라 적절한 처리를 함
아래와 같이 폼 클래스 정의(모든 폼 클래스는 django.forms.Form의 자식 클래스로 정의)
from django import forms

class NameForm(forms Form):
	your_name = forms.CharField(label=’Your name’, max_length=100)

위 예제는 필드가 your_name 하나인 폼 클래스. label 속성도 정의했음.
이는 렌더링되면 <label> 엘리먼트로 나타날 것임
필드의 최대 길이도 max_length 속성으로 지정했음(사용자가 100 글자 이상 입력하는 것을 방지하는 기능, 장고가 브라우저로부터 폼 데이터를 받았을 때 데이터의 길이가 유효한지 검사하는 데 사용됨)
각각의 폼 필드는 위젯 클래스를 갖고 있고 이 위젯 클래스는 <input type=”text”>와 같은 HTML 폼 위젯으로 대응됨. 대부분의 폼 필드는 디폴트 위젯을 갖고 있음. 
